Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: spacy in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (3.5.2)
Requirement already satisfied: catalogue<2.1.0,>=2.0.6 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (2.0.8)
Requirement already satisfied: thinc<8.2.0,>=8.1.8 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (8.1.9)
Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (1.0.9)
Requirement already satisfied: wasabi<1.2.0,>=0.9.1 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (1.1.1)
Requirement already satisfied: setuptools in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy) (61.2.0)
Requirement already satisfied: smart-open<7.0.0,>=5.2.1 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (6.3.0)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,<1.11.0,>=1.7.4 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (1.10.7)
Requirement already satisfied: typer<0.8.0,>=0.3.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (0.7.0)
Requirement already satisfied: pathy>=0.10.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (0.10.1)
Requirement already satisfied: srsly<3.0.0,>=2.4.3 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (2.4.6)
Requirement already satisfied: jinja2 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy) (2.11.3)
Requirement already satisfied: numpy>=1.15.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy) (1.21.5)
Requirement already satisfied: spacy-legacy<3.1.0,>=3.0.11 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (3.0.12)
Requirement already satisfied: langcodes<4.0.0,>=3.2.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (3.3.0)
Requirement already satisfied: packaging>=20.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy) (21.3)
Requirement already satisfied: cymem<2.1.0,>=2.0.2 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (2.0.7)
Requirement already satisfied: requests<3.0.0,>=2.13.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy) (2.27.1)
Requirement already satisfied: spacy-loggers<2.0.0,>=1.0.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (1.0.4)
Requirement already satisfied: preshed<3.1.0,>=3.0.2 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy) (3.0.8)
Requirement already satisfied: tqdm<5.0.0,>=4.38.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy) (4.64.0)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from packaging>=20.0->spacy) (3.0.4)
Requirement already satisfied: typing-extensions>=4.2.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from pydantic!=1.8,!=1.8.1,<1.11.0,>=1.7.4->spacy) (4.5.0)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from requests<3.0.0,>=2.13.0->spacy) (1.26.9)
Requirement already satisfied: charset-normalizer~=2.0.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from requests<3.0.0,>=2.13.0->spacy) (2.0.4)
Requirement already satisfied: idna<4,>=2.5 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from requests<3.0.0,>=2.13.0->spacy) (3.3)
Requirement already satisfied: certifi>=2017.4.17 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from requests<3.0.0,>=2.13.0->spacy) (2021.10.8)
Requirement already satisfied: confection<1.0.0,>=0.0.1 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from thinc<8.2.0,>=8.1.8->spacy) (0.0.4)
Requirement already satisfied: blis<0.8.0,>=0.7.8 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from thinc<8.2.0,>=8.1.8->spacy) (0.7.9)
Requirement already satisfied: click<9.0.0,>=7.1.1 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from typer<0.8.0,>=0.3.0->spacy) (8.0.4)
Requirement already satisfied: MarkupSafe>=0.23 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from jinja2->spacy) (2.0.1)
Defaulting to user installation because normal site-packages is not writeable
Collecting nb-core-news-sm==3.5.0
  Using cached https://github.com/explosion/spacy-models/releases/download/nb_core_news_sm-3.5.0/nb_core_news_sm-3.5.0-py3-none-any.whl (12.5 MB)
Requirement already satisfied: spacy<3.6.0,>=3.5.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from nb-core-news-sm==3.5.0) (3.5.2)
Requirement already satisfied: numpy>=1.15.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (1.21.5)
Requirement already satisfied: typer<0.8.0,>=0.3.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (0.7.0)
Requirement already satisfied: smart-open<7.0.0,>=5.2.1 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (6.3.0)
Requirement already satisfied: pathy>=0.10.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (0.10.1)
Requirement already satisfied: tqdm<5.0.0,>=4.38.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (4.64.0)
Requirement already satisfied: thinc<8.2.0,>=8.1.8 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (8.1.9)
Requirement already satisfied: langcodes<4.0.0,>=3.2.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (3.3.0)
Requirement already satisfied: requests<3.0.0,>=2.13.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (2.27.1)
Requirement already satisfied: spacy-legacy<3.1.0,>=3.0.11 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (3.0.12)
Requirement already satisfied: jinja2 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (2.11.3)
Requirement already satisfied: packaging>=20.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (21.3)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,<1.11.0,>=1.7.4 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (1.10.7)
Requirement already satisfied: catalogue<2.1.0,>=2.0.6 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (2.0.8)
Requirement already satisfied: setuptools in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (61.2.0)
Requirement already satisfied: wasabi<1.2.0,>=0.9.1 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (1.1.1)
Requirement already satisfied: cymem<2.1.0,>=2.0.2 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (2.0.7)
Requirement already satisfied: srsly<3.0.0,>=2.4.3 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (2.4.6)
Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (1.0.9)
Requirement already satisfied: spacy-loggers<2.0.0,>=1.0.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (1.0.4)
Requirement already satisfied: preshed<3.1.0,>=3.0.2 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (3.0.8)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from packaging>=20.0->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (3.0.4)
Requirement already satisfied: typing-extensions>=4.2.0 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from pydantic!=1.8,!=1.8.1,<1.11.0,>=1.7.4->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (4.5.0)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (1.26.9)
Requirement already satisfied: idna<4,>=2.5 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (3.3)
Requirement already satisfied: charset-normalizer~=2.0.0 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (2.0.4)
Requirement already satisfied: certifi>=2017.4.17 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (2021.10.8)
Requirement already satisfied: blis<0.8.0,>=0.7.8 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from thinc<8.2.0,>=8.1.8->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (0.7.9)
Requirement already satisfied: confection<1.0.0,>=0.0.1 in /cluster/home/eliaseb/.local/lib/python3.9/site-packages (from thinc<8.2.0,>=8.1.8->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (0.0.4)
Requirement already satisfied: click<9.0.0,>=7.1.1 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from typer<0.8.0,>=0.3.0->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (8.0.4)
Requirement already satisfied: MarkupSafe>=0.23 in /cluster/apps/eb/software/Anaconda3/2022.05/lib/python3.9/site-packages (from jinja2->spacy<3.6.0,>=3.5.0->nb-core-news-sm==3.5.0) (2.0.1)
[38;5;2m✔ Download and installation successful[0m
You can now load the package via spacy.load('nb_core_news_sm')
Found cached dataset csv (/cluster/home/eliaseb/.cache/huggingface/datasets/BiasedLiar___csv/BiasedLiar--nor_email_sum-b54d9abff15ab424/0.0.0/6b34fb8fcf56f7c8ba51dc895bfa2bfbe43546f190a60fcf74bb5e8afdcc2317)
Model gotten

  0%|          | 0/3 [00:00<?, ?it/s]
100%|██████████| 3/3 [00:00<00:00, 773.62it/s]
Loading cached processed dataset at /cluster/home/eliaseb/.cache/huggingface/datasets/BiasedLiar___csv/BiasedLiar--nor_email_sum-b54d9abff15ab424/0.0.0/6b34fb8fcf56f7c8ba51dc895bfa2bfbe43546f190a60fcf74bb5e8afdcc2317/cache-aec42a965fe92e9e.arrow

Map:   0%|          | 0/126 [00:00<?, ? examples/s]
Map: 100%|██████████| 126/126 [00:00<00:00, 461.66 examples/s]
                                                              
Loading cached processed dataset at /cluster/home/eliaseb/.cache/huggingface/datasets/BiasedLiar___csv/BiasedLiar--nor_email_sum-b54d9abff15ab424/0.0.0/6b34fb8fcf56f7c8ba51dc895bfa2bfbe43546f190a60fcf74bb5e8afdcc2317/cache-3a6fffa101824c2c.arrow
/cluster/home/eliaseb/.local/lib/python3.9/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
DatasetDict({
    train: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel', 'input_ids', 'attention_mask', 'labels'],
        num_rows: 1598
    })
    test: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel', 'input_ids', 'attention_mask', 'labels'],
        num_rows: 126
    })
    validation: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel', 'input_ids', 'attention_mask', 'labels'],
        num_rows: 126
    })
})
DatasetDict({
    train: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel', 'input_ids', 'attention_mask', 'labels'],
        num_rows: 1598
    })
    test: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel', 'input_ids', 'attention_mask', 'labels'],
        num_rows: 126
    })
    validation: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel', 'input_ids', 'attention_mask', 'labels'],
        num_rows: 126
    })
})
DatasetDict({
    train: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel'],
        num_rows: 1598
    })
    test: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel'],
        num_rows: 126
    })
    validation: Dataset({
        features: ['subject', 'text', 'label', 'goldlabel'],
        num_rows: 126
    })
})

  0%|          | 0/1600 [00:00<?, ?it/s]You're using a T5TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.

  0%|          | 1/1600 [00:18<8:06:29, 18.26s/it]/var/slurm_spool/job18000434/slurm_script: line 21: 2695147 Killed                  python no-mt5-huggingface.py
slurmstepd: error: Detected 1 oom_kill event in StepId=18000434.batch. Some of the step tasks have been OOM Killed.
